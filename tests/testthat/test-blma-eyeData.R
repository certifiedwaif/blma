library(parallel)

context("sampler eyeData")

vector_to_str <- function(vec)
{
	options(digits=16)
	cat("c(")
	for (i in 1:length(vec)) {
	  cat(vec[i])	
	  if (i < length(vec)) {
	  	  cat(",\n")
	  }
	}
	cat(")\n")
}

cores <- detectCores()
#cores <- 1

normalize <- function(y, X)
{
  n <- length(y)
  p <- ncol(X)

  mu.y <- mean(y)
  sigma2.y <- (n - 1) * var(y) / n
  vy <- (y - mu.y) / sqrt(sigma2.y)

  # Normalise covariates
  mX <- matrix(0, n, p)
  mu.x <- c()
  sigma2.x <- c()
  for (j in 1:p)
  {
    mu.x[j] <- mean(X[, j])
    sigma2.x[j] <- (n - 1) * var(X[, j]) / n
    mX[, j] <- (X[, j] - mu.x[j]) / sqrt(sigma2.x[j])
  }

  return(list(vy = vy, mX = mX, mu.y = mu.y, sigma2.y = sigma2.y, mu.x = mu.x, sigma2.x = sigma2.x))
}

get_eyeData <- function()
{
    data(eyeData)
    vy <- y
    mX <- x
    norm <- normalize(vy, mX)
    vy <- norm$vy
    mX <- norm$mX
    return(list(vy=vy, mX=mX))
}

test_that('eyeData produces correct results BIC', {
    skip("I don't care about this right now")
set.seed(2019)
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='BIC', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, 
c(
0.00001,0.99998,0.00001,0.99997,0.99998,0.00000,0.00001,0.99998,0.99996,
0.99995,0.00001,0.00000,0.99998,0.99997,0.99998,0.00000,0.00000,0.99997,
0.00001,0.99996,0.99997,0.00000,0.00002,0.00000,0.00000,0.00000,0.00000,
0.00001,0.00001,0.00000,0.99996,0.99998,0.00001,0.00001,0.99997,0.99995,
0.99997,0.00000,0.99995,0.99999,0.99998,0.99998,0.99995,0.99995,0.00000,
0.99996,0.99997,0.99996,0.99995,0.99999,0.99995,0.99995,0.99995,0.00001,
0.99998,0.99995,0.99998,0.99997,0.99995,0.00000,0.99997,0.99999,0.00000,
0.99996,0.00003,0.99996,0.00001,0.99995,0.99996,0.00000,0.99997,0.00000,
0.00000,0.99996,0.99996,0.99999,0.99996,0.00000,0.99997,0.99996,0.00000,
0.99997,0.00001,0.00002,0.00000,0.99995,0.99999,0.00000,0.99999,0.99998,
0.99996,0.99998,0.00001,0.00001,0.00000,0.99999,0.00000,0.99996,0.99996,
0.99997,0.99996,0.99996,0.99998,0.00000,0.00001,0.00001,0.99995,0.00001,
0.00001,0.99996,0.99995,0.00001,0.00002,0.99997,0.99995,0.99999,0.00002,
0.00000,0.99995,0.99996,0.00000,0.99999,0.00000,0.99998,0.99995,0.99999,
0.00001,0.00001,0.00000,0.99997,0.99995,0.00000,0.99995,0.99998,0.99995,
0.99996,0.00002,0.00001,0.99995,0.99997,0.99998,0.00000,0.00000,0.00001,
0.99995,0.99996,0.99998,0.00000,0.99996,0.00000,0.99997,0.00000,0.99995,
0.00000,0.99995,0.99998,0.99995,0.99996,0.99995,0.99995,0.99997,0.99995,
0.99997,0.99997,0.99997,0.99995,0.00000,0.00001,0.00001,0.99998,0.99996,
0.99997,0.99995,0.99999,0.99995,0.99995,0.99995,0.99997,0.99997,0.00000,
0.00000,0.99996,0.00000,0.00001,0.00000,0.00000,0.99999,0.99996,0.00000,
0.00000,0.99996,0.00000,0.00000,0.00000,0.00000,0.99997,0.00001,0.99996,
0.00000,0.99996
)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results ZE', {
    skip("I don't care about this right now")
	set.seed(2019)
	eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='ZE', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, 
c(
0.3072700000000000,0.3228100000000000,0.2584400000000000,
0.3558900000000000,0.3601700000000000,0.3418100000000000,
0.3852600000000000,0.4232200000000000,0.3806400000000000,
0.3380900000000000,0.3429000000000000,0.2862600000000000,
0.5333100000000000,0.6599100000000000,0.3031600000000000,
0.3763600000000000,0.3530600000000000,0.4377100000000000,
0.3582300000000000,0.3957100000000000,0.3283000000000000,
0.2829900000000000,0.2752800000000000,0.2979600000000000,
0.4179200000000000,0.2600300000000000,0.4207200000000000,
0.4116500000000000,0.4673300000000000,0.4078200000000000,
0.8490799999999999,0.2823200000000000,0.3266100000000000,
0.3390300000000000,0.3124400000000000,0.3449900000000000,
0.2989300000000000,0.3045300000000000,0.3932200000000000,
0.2894400000000000,0.5109399999999999,0.3739500000000000,
0.2899800000000000,0.3152600000000000,0.4527800000000000,
0.3371500000000000,0.3361200000000000,0.3429600000000000,
0.4814800000000000,0.5316400000000000,0.3025800000000000,
0.2989800000000000,0.3048400000000000,0.2969900000000000,
0.3382800000000000,0.2927700000000000,0.2964700000000000,
0.4498700000000000,0.2812300000000000,0.3913900000000000,
0.7489900000000000,0.3543100000000000,0.6298000000000000,
0.3890600000000000,0.2915300000000000,0.7833800000000000,
0.3534800000000000,0.2943900000000000,0.3044300000000000,
0.3640300000000000,0.9086500000000000,0.3502400000000000,
0.4669500000000000,0.3434600000000000,0.3223900000000000,
0.8493600000000000,0.4323400000000000,0.3816900000000000,
0.3792700000000000,0.3359000000000000,0.4094700000000000,
0.3527300000000000,0.3502000000000000,0.3860500000000000,
0.2902400000000000,0.2790300000000000,0.3496400000000000,
0.3489800000000000,0.2887300000000000,0.4258600000000000,
0.3026400000000000,0.3260100000000000,0.3497200000000000,
0.3128000000000000,0.2917600000000000,0.5627600000000000,
0.2814500000000000,0.2768800000000000,0.2723800000000000,
0.2862500000000000,0.3843800000000000,0.8277700000000000,
0.5384500000000000,0.3823700000000000,0.2683500000000000,
0.5612000000000000,0.3834500000000000,0.3066100000000000,
0.4043000000000000,0.3168100000000000,0.3169800000000000,
0.2739100000000000,0.5369800000000000,0.5291800000000000,
0.3833800000000000,0.2863400000000000,0.3684900000000000,
0.5533400000000001,0.2899700000000000,0.3105500000000000,
0.4019300000000000,0.3264600000000000,0.4868200000000000,
0.4719500000000000,0.4517700000000000,0.4150700000000000,
0.3257000000000000,0.2669600000000000,0.2904300000000000,
0.2782900000000000,0.4296300000000000,0.4636800000000000,
0.2931100000000000,0.8784800000000000,0.3002000000000000,
0.2729900000000000,0.4922000000000000,0.3859500000000000,
0.4582100000000000,0.5576900000000000,0.6193300000000000,
0.3316100000000000,0.3705900000000000,0.2861400000000000,
0.6840100000000000,0.4462500000000000,0.5289800000000000,
0.3609600000000000,0.3017000000000000,0.3686200000000000,
0.4566500000000000,0.4256400000000000,0.3627600000000000,
0.5163900000000000,0.7295800000000000,0.2828100000000000,
0.6754500000000000,0.2997800000000000,0.5095200000000000,
0.3129500000000000,0.5782700000000000,0.2870900000000000,
0.4172200000000000,0.6432099999999999,0.2922400000000000,
0.4412900000000000,0.2406500000000000,0.3053000000000000,
0.7484200000000000,0.2998000000000000,0.4271400000000000,
0.4707900000000000,0.2961300000000000,0.5917700000000000,
0.2772600000000000,0.3498500000000000,0.2996800000000000,
0.3008300000000000,0.4158700000000000,0.4240000000000000,
0.7877200000000000,0.2839900000000000,0.3613900000000000,
0.4009000000000000,0.7163700000000000,0.3260800000000000,
0.4611600000000000,0.6906900000000000,0.4531400000000000,
0.3078400000000000,0.5701300000000000,0.2944300000000000,
0.3725700000000000,0.2726800000000000,0.3058000000000000,
0.6885900000000000,0.5033600000000000,0.3223700000000000,
0.2634000000000000,0.3876600000000000
)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results liang_g1', {
			  skip('This fails with a gsl hyperg_2F1 error handler error')
set.seed(2019)
browser()
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='liang_g1', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, c(0.003888497230715404,
0.005603326220676895,
0.002933945443797199,
0.00228822150776619,
0.0026,
0.0042,
0.0021,
0.0035,
0.0016,
0.0023,
0.0596,
0.0035,
0.0032,
0.0034,
0.002,
0.0036,
0.0019,
0.0026,
0.0033,
0.0013,
0.0022,
0.0038,
0.0018,
0.002,
0.0023,
0.0025,
0.0012,
0.012,
0.0023,
0.0049,
0.0055,
0.0018,
0.004,
0.0019,
0.0019,
0.0105,
0.0022,
0.0035,
0.0027,
0.0019,
0.0017,
0.0436,
0.0021,
0.0028,
0.0017,
0.0027,
0.0033,
0.0024,
0.0037,
0.0058,
0.0021,
0.0036,
0.0023,
0.0116,
0.0122,
0.0017,
0.0018,
0.0026,
0.0042,
0.0108,
0.0024,
0.0394,
0.0034,
0.003,
0.003,
0.0089,
0.0027,
0.0023,
0.0018,
0.0019,
0.0185,
0.0015,
0.002,
0.0026,
0.0019,
0.0223,
0.0027,
0.0029,
0.0018,
0.0025,
0.0013,
0.0028,
0.0019,
0.0017,
0.0056,
0.0018,
0.1857,
0.0025,
0.0026,
0.0223,
0.0015,
0.008800000000000001,
0.003,
0.0022,
0.0025,
0.0063,
0.0023,
0.002,
0.019,
0.0018,
0.0025,
0.0101,
0.0017,
0.0049,
0.0015,
0.0014,
0.0045,
0.0049,
0.0254,
0.009599999999999999,
0.0046,
0.0201,
0.004,
0.0022,
0.0022,
0.0011,
0.0051,
0.0021,
0.0012,
9e-04,
0.0024,
0.0017,
0.008500000000000001,
0.0043,
0.0105,
0.0024,
0.0109,
0.0028,
0.002,
0.003,
0.002,
0.0091,
0.0027,
0.01,
0.0055,
0.0264,
0.0034,
0.001,
0.0018,
0.0129,
0.0158,
0.0023,
0.0032,
0.0018,
0.0025,
0.0116,
0.0077,
0.0055,
0.0017,
0.0018,
0.0039,
0.0039,
0.9422,
0.0069,
0.0365,
0.0029,
0.0098,
0.009299999999999999,
0.0153,
0.0021,
0.0066,
0.0074,
0.0026,
0.0193,
0.0021,
0.0023,
0.0021,
0.0029,
0.0023,
0.0036,
0.002,
0.0239,
0.0042,
0.0027,
0.0049,
0.0029,
0.0083,
0.0017,
0.0043,
0.7452,
0.0606,
0.0205,
0.0068,
0.0059,
0.7236,
0.0026,
0.0467,
0.0111,
0.0042,
0.004,
0.003,
0.0016,
0.0029,
0.0023,
0.0016,
0.0036,
0.002,
0.0033,
0.0051,
0.061)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results liang_g2', {
    skip("I don't care about this right now")
set.seed(2019)
browser()
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='liang_g2', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, 
c(
0.3214700000000000,0.3416500000000000,0.2992300000000000,
0.4014000000000000,0.3666200000000000,0.3589000000000000,
0.3331200000000000,0.4078700000000000,0.3273400000000000,
0.3497700000000000,0.3638000000000000,0.2996600000000000,
0.6089800000000000,0.5670200000000000,0.3116200000000000,
0.3750900000000000,0.3253100000000000,0.3904200000000000,
0.3715100000000000,0.3997600000000000,0.3473400000000000,
0.3157900000000000,0.3257800000000000,0.3230400000000000,
0.3388500000000000,0.2867500000000000,0.3320900000000000,
0.3267600000000000,0.3717700000000000,0.3438400000000000,
0.8050100000000000,0.3050900000000000,0.3394400000000000,
0.2998700000000000,0.3316700000000000,0.3750300000000000,
0.3218400000000000,0.3392200000000000,0.4243500000000000,
0.3269500000000000,0.5938800000000000,0.3789400000000000,
0.3109300000000000,0.3097800000000000,0.3664000000000000,
0.3770400000000000,0.3821000000000000,0.3681600000000000,
0.4187400000000000,0.5604900000000000,0.3396200000000000,
0.3034400000000000,0.3210400000000000,0.3202200000000000,
0.3459500000000000,0.3179200000000000,0.2928000000000000,
0.3978900000000000,0.3268900000000000,0.3974300000000000,
0.6982699999999999,0.3738800000000000,0.5348400000000000,
0.3122300000000000,0.3005100000000000,0.7429400000000000,
0.3706500000000000,0.2961600000000000,0.3382400000000000,
0.2850900000000000,0.8689200000000000,0.3430800000000000,
0.4355100000000000,0.3449600000000000,0.3359500000000000,
0.8140800000000000,0.3744800000000000,0.3250400000000000,
0.3130400000000000,0.3409800000000000,0.3985700000000000,
0.3728000000000000,0.2929800000000000,0.3135100000000000,
0.3049400000000000,0.3290500000000000,0.4218400000000000,
0.3751900000000000,0.3157200000000000,0.3637700000000000,
0.3180400000000000,0.3804400000000000,0.3859100000000000,
0.3145500000000000,0.3177100000000000,0.5937200000000000,
0.2987600000000000,0.3185200000000000,0.3053500000000000,
0.2953200000000000,0.3849000000000000,0.7360200000000000,
0.5091200000000000,0.3135800000000000,0.3022900000000000,
0.4720200000000000,0.3302000000000000,0.3254700000000000,
0.3310100000000000,0.3104500000000000,0.3409800000000000,
0.2913100000000000,0.4347400000000000,0.5464700000000000,
0.3086100000000000,0.3024000000000000,0.3592200000000000,
0.4473900000000000,0.3177200000000000,0.3193600000000000,
0.3342100000000000,0.3320300000000000,0.5365000000000000,
0.5102800000000000,0.4554400000000000,0.3568000000000000,
0.3139700000000000,0.3050400000000000,0.2982100000000000,
0.2841900000000000,0.3338400000000000,0.3917300000000000,
0.3126100000000000,0.8021600000000000,0.3173000000000000,
0.3131900000000000,0.3975200000000000,0.3000700000000000,
0.3790400000000000,0.5994000000000000,0.6083300000000000,
0.3783500000000000,0.3021000000000000,0.3189000000000000,
0.5761600000000000,0.3923000000000000,0.4662800000000000,
0.3566300000000000,0.3324800000000000,0.3884600000000000,
0.3801900000000000,0.4092300000000000,0.3902500000000000,
0.5465100000000001,0.6628300000000000,0.3046600000000000,
0.6193400000000000,0.3042900000000000,0.4087600000000000,
0.3215300000000000,0.4902200000000000,0.3031900000000000,
0.4241900000000000,0.5317400000000000,0.3128400000000000,
0.4410800000000000,0.2800400000000000,0.3291000000000000,
0.6523700000000000,0.3218500000000000,0.4851000000000000,
0.3792100000000000,0.3307700000000000,0.6756300000000000,
0.2948600000000000,0.4093000000000000,0.3169100000000000,
0.3258900000000000,0.4328400000000000,0.3965700000000000,
0.7402000000000000,0.3059300000000000,0.3750000000000000,
0.4318300000000000,0.6282300000000000,0.3179000000000000,
0.4834600000000000,0.5970700000000000,0.3628300000000000,
0.3061400000000000,0.5934000000000000,0.3189000000000000,
0.3930700000000000,0.3118100000000000,0.3295700000000000,
0.6352700000000000,0.4346400000000000,0.2956400000000000,
0.3041600000000000,0.4318700000000000
)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results liang_g_n_approx', {
    skip("I don't care about this right now")
set.seed(2019)
browser()
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='liang_g_n_approx', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, 
c(
0.6190200000000000,0.2820100000000000,0.2020500000000000,
0.2459000000000000,0.5296800000000000,0.3376200000000000,
0.4775300000000000,0.5845000000000000,0.2353700000000000,
0.4829500000000000,0.5796900000000000,0.2623300000000000,
0.6710199999999999,0.3861300000000000,0.6535900000000000,
0.2282000000000000,0.2526500000000000,0.6841500000000000,
0.2449100000000000,0.4225100000000000,0.2201400000000000,
0.5611500000000000,0.5276300000000000,0.2334400000000000,
0.3693100000000000,0.1984200000000000,0.5941700000000000,
0.5503900000000000,0.4879100000000000,0.3089400000000000,
0.5070700000000000,0.2087700000000000,0.5277200000000000,
0.5536300000000000,0.2176000000000000,0.2842900000000000,
0.5456700000000000,0.2316600000000000,0.4381800000000000,
0.5517200000000000,0.6509900000000000,0.2976300000000000,
0.2817500000000000,0.2319900000000000,0.6256300000000000,
0.5492100000000000,0.5394500000000000,0.4005500000000000,
0.4286200000000000,0.6969100000000000,0.2151200000000000,
0.2487700000000000,0.2780200000000000,0.2093100000000000,
0.3333400000000000,0.3451900000000000,0.5592800000000000,
0.6653300000000000,0.5144000000000000,0.6684400000000000,
0.7651800000000000,0.5727200000000000,0.3500700000000000,
0.2462200000000000,0.2403200000000000,0.9121700000000000,
0.6303299999999999,0.2087700000000000,0.2664800000000000,
0.3380600000000000,0.9545500000000000,0.5266900000000000,
0.4974600000000000,0.2599800000000000,0.5127900000000000,
0.8696000000000000,0.5718400000000000,0.4987000000000000,
0.5275200000000000,0.2836400000000000,0.3992100000000000,
0.7100300000000000,0.5105000000000000,0.2383100000000000,
0.5860700000000000,0.2487900000000000,0.2881300000000000,
0.5796100000000000,0.2983500000000000,0.2763400000000000,
0.3226700000000000,0.2674400000000000,0.6486499999999999,
0.5891100000000000,0.2375300000000000,0.3937900000000000,
0.2616800000000000,0.2143600000000000,0.4926700000000000,
0.2112500000000000,0.3057600000000000,0.8699500000000000,
0.3290200000000000,0.2084300000000000,0.2718800000000000,
0.6261900000000000,0.1840600000000000,0.3191400000000000,
0.2513500000000000,0.2414100000000000,0.5736200000000000,
0.2003700000000000,0.5978900000000000,0.5963800000000000,
0.6339100000000000,0.2430200000000000,0.6143000000000000,
0.6256500000000000,0.5140600000000000,0.2875500000000000,
0.2200200000000000,0.4556900000000000,0.6943700000000000,
0.7380500000000000,0.5109000000000000,0.2789400000000000,
0.3243500000000000,0.5594800000000000,0.2471100000000000,
0.2023200000000000,0.3574400000000000,0.5135500000000000,
0.5408500000000001,0.9301700000000001,0.3078000000000000,
0.2391000000000000,0.6406700000000000,0.2822900000000000,
0.3024300000000000,0.6700400000000000,0.7315400000000000,
0.6009200000000000,0.2249200000000000,0.5366200000000000,
0.8502500000000000,0.3484500000000000,0.3725900000000000,
0.3027500000000000,0.5812000000000000,0.3011100000000000,
0.2776400000000000,0.3265200000000000,0.3132700000000000,
0.6013900000000000,0.8731800000000000,0.2864600000000000,
0.7690600000000000,0.3062700000000000,0.6463100000000001,
0.6420600000000000,0.4272400000000000,0.2160600000000000,
0.6690800000000000,0.4577200000000000,0.4963500000000000,
0.6848400000000000,0.5491100000000000,0.2684200000000000,
0.7870700000000000,0.2650600000000000,0.3510400000000000,
0.6276900000000000,0.5477700000000000,0.7902000000000000,
0.2572400000000000,0.2951300000000000,0.2734300000000000,
0.3350600000000000,0.7555100000000000,0.3111500000000000,
0.9321500000000000,0.5611800000000000,0.2762900000000000,
0.6349399999999999,0.5491400000000000,0.2183000000000000,
0.4634000000000000,0.7076300000000000,0.3110100000000000,
0.5057700000000001,0.7406100000000000,0.2651200000000000,
0.4685800000000000,0.2618800000000000,0.3001400000000000,
0.5673700000000000,0.6921200000000000,0.1815000000000000,
0.2068000000000000,0.2824600000000000
)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results liang_g_n_quad', {
    skip("I don't care about this right now")
set.seed(2019)
browser()
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='liang_g_n_quad', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, 
c(
0.4157600000000000,0.3546600000000000,0.3690200000000000,
0.3646200000000000,0.4157100000000000,0.3432200000000000,
0.3273600000000000,0.4682100000000000,0.3095100000000000,
0.4020800000000000,0.4180200000000000,0.3174500000000000,
0.5308300000000000,0.5900500000000000,0.2607300000000000,
0.4507700000000000,0.2853200000000000,0.4757200000000000,
0.2991400000000000,0.4814500000000000,0.3136700000000000,
0.3029200000000000,0.3060900000000000,0.3056400000000000,
0.3039000000000000,0.2882000000000000,0.3216500000000000,
0.3330600000000000,0.3523600000000000,0.2892300000000000,
0.7322700000000000,0.3694200000000000,0.3318700000000000,
0.2700200000000000,0.3277700000000000,0.3538600000000000,
0.3346300000000000,0.3023500000000000,0.4458100000000000,
0.2897900000000000,0.4974000000000000,0.4879300000000000,
0.2902000000000000,0.2832700000000000,0.3799800000000000,
0.3351300000000000,0.3696000000000000,0.4042100000000000,
0.5224200000000000,0.5919400000000000,0.3177400000000000,
0.3527100000000000,0.3960700000000000,0.2927400000000000,
0.4216600000000000,0.2998200000000000,0.2593200000000000,
0.4469000000000000,0.2948200000000000,0.4173000000000000,
0.7953800000000000,0.4313600000000000,0.5756400000000000,
0.2938000000000000,0.2964000000000000,0.7170200000000000,
0.4386100000000000,0.2718700000000000,0.3167400000000000,
0.2945500000000000,0.9095600000000000,0.3371300000000000,
0.5634200000000000,0.3304000000000000,0.3201600000000000,
0.7826500000000000,0.3642900000000000,0.3068100000000000,
0.2783700000000000,0.3710700000000000,0.4076200000000000,
0.5051300000000000,0.2840800000000000,0.3138700000000000,
0.2962800000000000,0.3015100000000000,0.3337600000000000,
0.3525500000000000,0.3074300000000000,0.3270500000000000,
0.3095800000000000,0.2972300000000000,0.3782000000000000,
0.3755000000000000,0.3824000000000000,0.6492100000000000,
0.3822100000000000,0.3288500000000000,0.2582700000000000,
0.2942600000000000,0.3602400000000000,0.8194900000000001,
0.4999600000000000,0.3206600000000000,0.3130300000000000,
0.4824700000000000,0.3019600000000000,0.3056400000000000,
0.4465900000000000,0.3662900000000000,0.3767600000000000,
0.2539800000000000,0.4122600000000000,0.4913200000000000,
0.3191200000000000,0.3803400000000000,0.4562000000000000,
0.4736900000000000,0.3059800000000000,0.3093700000000000,
0.2956800000000000,0.3322800000000000,0.5931700000000000,
0.5666000000000000,0.4247700000000000,0.4462200000000000,
0.2742600000000000,0.2693800000000000,0.2784100000000000,
0.2695700000000000,0.2941100000000000,0.3673200000000000,
0.2913200000000000,0.8722000000000000,0.3074900000000000,
0.3223900000000000,0.3625000000000000,0.3959900000000000,
0.4260500000000000,0.5809500000000000,0.6338200000000001,
0.3489100000000000,0.2664300000000000,0.2833100000000000,
0.6654800000000000,0.4139700000000000,0.4299400000000000,
0.3399200000000000,0.3152700000000000,0.3676400000000000,
0.3764500000000000,0.4274600000000000,0.3838600000000000,
0.5238100000000000,0.6458400000000000,0.2882400000000000,
0.5838100000000001,0.2858500000000000,0.4943900000000000,
0.3119100000000000,0.5099700000000000,0.3081600000000000,
0.4343400000000000,0.5553800000000000,0.2823200000000000,
0.5318100000000000,0.2724100000000000,0.3588200000000000,
0.7413400000000000,0.3113800000000000,0.5203500000000000,
0.3621900000000000,0.3916200000000000,0.7353300000000000,
0.3844700000000000,0.3852300000000000,0.3773900000000000,
0.4349300000000000,0.4158000000000000,0.3708800000000000,
0.8187400000000000,0.2895100000000000,0.4196000000000000,
0.5008899999999999,0.7267100000000000,0.2801100000000000,
0.5467900000000000,0.5676900000000000,0.3605700000000000,
0.4205300000000000,0.6517400000000000,0.2748000000000000,
0.4627200000000000,0.2648200000000000,0.4071700000000000,
0.7121700000000000,0.5406100000000000,0.2641300000000000,
0.2666300000000000,0.3598100000000000
)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results robust_bayarri1', {
	skip("Running on lhcb")
	set.seed(2019)
	browser()
	eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='robust_bayarri1', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, 
c(
0.3293200000000000,0.3536400000000000,0.2957900000000000,
0.4016700000000000,0.3606600000000000,0.3409500000000000,
0.3404900000000000,0.4142600000000000,0.3204400000000000,
0.3297200000000000,0.3658700000000000,0.2988200000000000,
0.6038000000000000,0.5953500000000000,0.3090100000000000,
0.3923100000000000,0.3017100000000000,0.4041300000000000,
0.3632100000000000,0.3926200000000000,0.3392900000000000,
0.3219700000000000,0.3219000000000000,0.3364900000000000,
0.3144600000000000,0.2870700000000000,0.3384900000000000,
0.3276800000000000,0.3573400000000000,0.3217900000000000,
0.8112800000000000,0.2948000000000000,0.3452200000000000,
0.2989800000000000,0.3406400000000000,0.3761900000000000,
0.3141100000000000,0.3334300000000000,0.4268200000000000,
0.3265700000000000,0.5945600000000000,0.3811400000000000,
0.3213200000000000,0.3136800000000000,0.3618200000000000,
0.3853900000000000,0.3823000000000000,0.3667200000000000,
0.4448700000000000,0.5730600000000000,0.3435600000000000,
0.3144600000000000,0.3172000000000000,0.3222100000000000,
0.3443800000000000,0.3222000000000000,0.2951400000000000,
0.4036400000000000,0.3157800000000000,0.4033500000000000,
0.7169000000000000,0.3595300000000000,0.5367200000000000,
0.3085300000000000,0.3035300000000000,0.7460700000000000,
0.3590400000000000,0.2844200000000000,0.3410900000000000,
0.2803100000000000,0.8792100000000000,0.3439900000000000,
0.4475400000000000,0.3569000000000000,0.3413200000000000,
0.8158400000000000,0.3844200000000000,0.3151200000000000,
0.3160600000000000,0.3370000000000000,0.4044800000000000,
0.3660500000000000,0.2740800000000000,0.3060900000000000,
0.3054600000000000,0.3299700000000000,0.4163500000000000,
0.3735600000000000,0.3149800000000000,0.3619200000000000,
0.3152200000000000,0.3689800000000000,0.3789400000000000,
0.3073200000000000,0.3063700000000000,0.6035400000000000,
0.2975700000000000,0.3125300000000000,0.2933500000000000,
0.3042300000000000,0.3804500000000000,0.7598400000000000,
0.4952200000000000,0.3102600000000000,0.2968100000000000,
0.4651500000000000,0.3233000000000000,0.3245200000000000,
0.3360000000000000,0.3222500000000000,0.3238700000000000,
0.2841700000000000,0.4268600000000000,0.5318300000000000,
0.3194300000000000,0.3099900000000000,0.3548600000000000,
0.4544400000000000,0.3117400000000000,0.3231400000000000,
0.3119300000000000,0.3267700000000000,0.5293000000000000,
0.5294300000000000,0.4493400000000000,0.3619200000000000,
0.3176800000000000,0.2880400000000000,0.2944100000000000,
0.2764700000000000,0.3275300000000000,0.3766900000000000,
0.3192700000000000,0.8187000000000000,0.3166000000000000,
0.3130900000000000,0.3757100000000000,0.3155500000000000,
0.3738100000000000,0.5860500000000000,0.6223600000000000,
0.3650000000000000,0.3009000000000000,0.3171900000000000,
0.5702900000000000,0.3898800000000000,0.4520600000000000,
0.3590700000000000,0.3309600000000000,0.3996000000000000,
0.3788200000000000,0.4180600000000000,0.3960200000000000,
0.5558999999999999,0.6606500000000000,0.3122800000000000,
0.6287600000000000,0.2947300000000000,0.4237200000000000,
0.3199500000000000,0.4992000000000000,0.3023100000000000,
0.4303400000000000,0.5428200000000000,0.3063500000000000,
0.4419100000000000,0.2704100000000000,0.3359000000000000,
0.6401400000000000,0.3351700000000000,0.4911500000000000,
0.3622300000000000,0.3129900000000000,0.6847800000000001,
0.2879600000000000,0.4020200000000000,0.3205300000000000,
0.3157100000000000,0.4237500000000000,0.3820300000000000,
0.7512600000000000,0.3055100000000000,0.3719300000000000,
0.4468400000000000,0.6351100000000000,0.2939700000000000,
0.5025700000000000,0.5956100000000000,0.3720000000000000,
0.3090700000000000,0.5860400000000000,0.3192900000000000,
0.3876300000000000,0.3011600000000000,0.3211700000000000,
0.6387200000000000,0.4221300000000000,0.3011900000000000,
0.3042300000000000,0.4193700000000000
)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results robust_bayarri2', {
	skip("Running on alice")
	set.seed(2019)
	browser()
	eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='robust_bayarri2', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, 
c(
0.3254700000000000,0.3427100000000000,0.3097900000000000,
0.3914600000000000,0.3617600000000000,0.3521000000000000,
0.3317000000000000,0.3885400000000000,0.3221300000000000,
0.3374100000000000,0.3581500000000000,0.3110400000000000,
0.5885600000000000,0.5888099999999999,0.3104400000000000,
0.3926300000000000,0.3050600000000000,0.3992400000000000,
0.3672500000000000,0.3976600000000000,0.3510200000000000,
0.3192000000000000,0.3215000000000000,0.3208800000000000,
0.3104800000000000,0.2783500000000000,0.3320000000000000,
0.3338100000000000,0.3703700000000000,0.3335300000000000,
0.8195000000000000,0.3072800000000000,0.3365800000000000,
0.3006400000000000,0.3352600000000000,0.3624800000000000,
0.3214900000000000,0.3290900000000000,0.4145600000000000,
0.3140400000000000,0.5884400000000000,0.3848200000000000,
0.3319600000000000,0.3108400000000000,0.3736900000000000,
0.3711400000000000,0.3738600000000000,0.3701400000000000,
0.4184300000000000,0.5502100000000000,0.3544900000000000,
0.3080500000000000,0.3072700000000000,0.3077000000000000,
0.3524900000000000,0.3213500000000000,0.2864700000000000,
0.4011100000000000,0.3223900000000000,0.3870900000000000,
0.7049700000000000,0.3602400000000000,0.5469700000000000,
0.3037700000000000,0.2993700000000000,0.7513100000000000,
0.3607200000000000,0.2975100000000000,0.3410100000000000,
0.2899300000000000,0.8769200000000000,0.3403400000000000,
0.4269300000000000,0.3490600000000000,0.3563800000000000,
0.8224800000000000,0.3713500000000000,0.3195300000000000,
0.3039900000000000,0.3470500000000000,0.4152100000000000,
0.3688300000000000,0.2846000000000000,0.3094500000000000,
0.3226100000000000,0.3220300000000000,0.4174600000000000,
0.3724200000000000,0.3150700000000000,0.3661700000000000,
0.3335300000000000,0.3669000000000000,0.4002300000000000,
0.3271500000000000,0.3152100000000000,0.5973500000000000,
0.2899200000000000,0.3092300000000000,0.2900200000000000,
0.3028800000000000,0.3867200000000000,0.7533100000000000,
0.4964400000000000,0.3046100000000000,0.3037700000000000,
0.4618000000000000,0.3311500000000000,0.3249300000000000,
0.3349400000000000,0.3076600000000000,0.3235600000000000,
0.2819900000000000,0.4434100000000000,0.5448400000000000,
0.3058600000000000,0.3126100000000000,0.3506600000000000,
0.4574000000000000,0.3212000000000000,0.3191000000000000,
0.3255600000000000,0.3196600000000000,0.5206800000000000,
0.5287700000000000,0.4522900000000000,0.3583000000000000,
0.3083400000000000,0.3174300000000000,0.2940000000000000,
0.2835600000000000,0.3135400000000000,0.3898600000000000,
0.3147400000000000,0.8065500000000000,0.3234100000000000,
0.3104100000000000,0.3919400000000000,0.3156000000000000,
0.3768500000000000,0.5987600000000000,0.6080600000000000,
0.3719000000000000,0.3064100000000000,0.3211200000000000,
0.5818500000000000,0.4007000000000000,0.4558000000000000,
0.3616500000000000,0.3207300000000000,0.4081400000000000,
0.4009400000000000,0.4350500000000000,0.3969200000000000,
0.5596300000000000,0.6567400000000000,0.3068600000000000,
0.6107900000000001,0.3022600000000000,0.3875400000000000,
0.3169500000000000,0.5056100000000000,0.3004800000000000,
0.4251700000000000,0.5522899999999999,0.3155300000000000,
0.4370000000000000,0.2840400000000000,0.3329700000000000,
0.6607300000000000,0.3102900000000000,0.4649600000000000,
0.3605000000000000,0.3124500000000000,0.6838100000000000,
0.2991800000000000,0.4079600000000000,0.3159600000000000,
0.3225000000000000,0.4333100000000000,0.3915000000000000,
0.7540100000000000,0.3016400000000000,0.3699500000000000,
0.4406100000000000,0.6371900000000000,0.3145600000000000,
0.4880600000000000,0.6223300000000000,0.3757400000000000,
0.3087600000000000,0.5707400000000000,0.3156300000000000,
0.3799400000000000,0.2965400000000000,0.3273700000000000,
0.6325300000000000,0.4180000000000000,0.3040400000000000,
0.2962900000000000,0.4250800000000000
)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results zellner_siow_gauss_laguerre', {
	set.seed(2019)
	browser()
	eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='zellner_siow_gauss_laguerre', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob,
c(
0.3369500000000000,0.3746000000000000,0.2998200000000000,
0.3826200000000000,0.3723800000000000,0.3558200000000000,
0.3196400000000000,0.4152900000000000,0.3073700000000000,
0.3522500000000000,0.3918500000000000,0.3116700000000000,
0.6258600000000000,0.5961200000000000,0.3336800000000000,
0.4038500000000000,0.3214300000000000,0.4241600000000000,
0.3475100000000000,0.4222400000000000,0.3348700000000000,
0.3254100000000000,0.3222800000000000,0.3327100000000000,
0.3277700000000000,0.2664800000000000,0.3494800000000000,
0.3450800000000000,0.3827700000000000,0.3384100000000000,
0.8418700000000000,0.3058200000000000,0.3441800000000000,
0.3055800000000000,0.3415500000000000,0.3754800000000000,
0.3263200000000000,0.3309500000000000,0.4800500000000000,
0.3049500000000000,0.5941800000000000,0.3945900000000000,
0.3023100000000000,0.3058300000000000,0.3478900000000000,
0.3569300000000000,0.3985700000000000,0.3863800000000000,
0.4410500000000000,0.5972900000000000,0.3649400000000000,
0.3282700000000000,0.3153300000000000,0.3140300000000000,
0.3712600000000000,0.3262100000000000,0.2783100000000000,
0.4315200000000000,0.3018700000000000,0.4355600000000000,
0.7558600000000000,0.3833400000000000,0.5543600000000000,
0.2917900000000000,0.3097100000000000,0.7609200000000000,
0.3655600000000000,0.2777300000000000,0.3337600000000000,
0.2763200000000000,0.9082100000000000,0.3707700000000000,
0.4964200000000000,0.3692500000000000,0.3537500000000000,
0.8249000000000000,0.3948500000000000,0.3158600000000000,
0.2960000000000000,0.3433700000000000,0.4331500000000000,
0.4362400000000000,0.2903600000000000,0.3077200000000000,
0.3039700000000000,0.3102200000000000,0.3808900000000000,
0.3714400000000000,0.3328600000000000,0.3818200000000000,
0.3344100000000000,0.3537000000000000,0.4249500000000000,
0.3266500000000000,0.2990300000000000,0.5979800000000000,
0.3158200000000000,0.3220800000000000,0.3047400000000000,
0.2989400000000000,0.3860500000000000,0.8424000000000000,
0.5315700000000000,0.3180500000000000,0.3000700000000000,
0.5077900000000000,0.3345000000000000,0.3146800000000000,
0.3348300000000000,0.3015700000000000,0.3407900000000000,
0.2802500000000000,0.4432100000000000,0.5468000000000000,
0.3433000000000000,0.3319000000000000,0.3548400000000000,
0.5355100000000000,0.3338200000000000,0.3588500000000000,
0.3029100000000000,0.3490200000000000,0.5865000000000000,
0.5665900000000000,0.4772900000000000,0.3875000000000000,
0.3064500000000000,0.2971800000000000,0.2856600000000000,
0.2979400000000000,0.2999100000000000,0.4068700000000000,
0.3118800000000000,0.8466200000000000,0.3366300000000000,
0.3200400000000000,0.4038100000000000,0.3152100000000000,
0.3740700000000000,0.5810600000000000,0.6652500000000000,
0.3929900000000000,0.2952400000000000,0.3128200000000000,
0.6194100000000000,0.3826700000000000,0.4674500000000000,
0.3827200000000000,0.3222200000000000,0.4018600000000000,
0.4312800000000000,0.4424000000000000,0.4064600000000000,
0.5944400000000000,0.7148800000000000,0.3399000000000000,
0.6266500000000000,0.2898100000000000,0.4680900000000000,
0.3440500000000000,0.5383599999999999,0.3041900000000000,
0.4456200000000000,0.5580500000000000,0.3079000000000000,
0.4823600000000000,0.2716400000000000,0.3475000000000000,
0.7301700000000000,0.3218700000000000,0.5020200000000000,
0.4078900000000000,0.2968000000000000,0.6722700000000000,
0.2838000000000000,0.4277300000000000,0.3144300000000000,
0.3377800000000000,0.4666800000000000,0.3578500000000000,
0.7716800000000000,0.3059500000000000,0.4110600000000000,
0.4553700000000000,0.6692800000000000,0.3082000000000000,
0.4956700000000000,0.6207700000000000,0.3708000000000000,
0.3121400000000000,0.6617499999999999,0.3006300000000000,
0.4240700000000000,0.2963100000000000,0.3318700000000000,
0.6662500000000000,0.4739300000000000,0.2879700000000000,
0.2858900000000000,0.4073200000000000
)
, tolerance = 1e-8)
})
