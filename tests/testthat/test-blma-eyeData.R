library(parallel)

context("sampler eyeData")

vector_to_str <- function(vec)
{
	options(digits=16)
	cat("c(")
	for (i in 1:length(vec)) {
	  cat(vec[i])	
	  if (i < length(vec)) {
	  	  cat(",\n")
	  }
	}
	cat(")\n")
}

cores <- detectCores()
#cores <- 1

normalize <- function(y, X)
{
  n <- length(y)
  p <- ncol(X)

  mu.y <- mean(y)
  sigma2.y <- (n - 1) * var(y) / n
  vy <- (y - mu.y) / sqrt(sigma2.y)

  # Normalise covariates
  mX <- matrix(0, n, p)
  mu.x <- c()
  sigma2.x <- c()
  for (j in 1:p)
  {
    mu.x[j] <- mean(X[, j])
    sigma2.x[j] <- (n - 1) * var(X[, j]) / n
    mX[, j] <- (X[, j] - mu.x[j]) / sqrt(sigma2.x[j])
  }

  return(list(vy = vy, mX = mX, mu.y = mu.y, sigma2.y = sigma2.y, mu.x = mu.x, sigma2.x = sigma2.x))
}

get_eyeData <- function()
{
    data(eyeData)
    vy <- y
    mX <- x
    norm <- normalize(vy, mX)
    vy <- norm$vy
    mX <- norm$mX
    return(list(vy=vy, mX=mX))
}

test_that('eyeData produces correct results BIC', {
    skip("I don't care about this right now")
set.seed(2019)
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='BIC', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, 
c(
0.00001,0.99998,0.00001,0.99997,0.99998,0.00000,0.00001,0.99998,0.99996,
0.99995,0.00001,0.00000,0.99998,0.99997,0.99998,0.00000,0.00000,0.99997,
0.00001,0.99996,0.99997,0.00000,0.00002,0.00000,0.00000,0.00000,0.00000,
0.00001,0.00001,0.00000,0.99996,0.99998,0.00001,0.00001,0.99997,0.99995,
0.99997,0.00000,0.99995,0.99999,0.99998,0.99998,0.99995,0.99995,0.00000,
0.99996,0.99997,0.99996,0.99995,0.99999,0.99995,0.99995,0.99995,0.00001,
0.99998,0.99995,0.99998,0.99997,0.99995,0.00000,0.99997,0.99999,0.00000,
0.99996,0.00003,0.99996,0.00001,0.99995,0.99996,0.00000,0.99997,0.00000,
0.00000,0.99996,0.99996,0.99999,0.99996,0.00000,0.99997,0.99996,0.00000,
0.99997,0.00001,0.00002,0.00000,0.99995,0.99999,0.00000,0.99999,0.99998,
0.99996,0.99998,0.00001,0.00001,0.00000,0.99999,0.00000,0.99996,0.99996,
0.99997,0.99996,0.99996,0.99998,0.00000,0.00001,0.00001,0.99995,0.00001,
0.00001,0.99996,0.99995,0.00001,0.00002,0.99997,0.99995,0.99999,0.00002,
0.00000,0.99995,0.99996,0.00000,0.99999,0.00000,0.99998,0.99995,0.99999,
0.00001,0.00001,0.00000,0.99997,0.99995,0.00000,0.99995,0.99998,0.99995,
0.99996,0.00002,0.00001,0.99995,0.99997,0.99998,0.00000,0.00000,0.00001,
0.99995,0.99996,0.99998,0.00000,0.99996,0.00000,0.99997,0.00000,0.99995,
0.00000,0.99995,0.99998,0.99995,0.99996,0.99995,0.99995,0.99997,0.99995,
0.99997,0.99997,0.99997,0.99995,0.00000,0.00001,0.00001,0.99998,0.99996,
0.99997,0.99995,0.99999,0.99995,0.99995,0.99995,0.99997,0.99997,0.00000,
0.00000,0.99996,0.00000,0.00001,0.00000,0.00000,0.99999,0.99996,0.00000,
0.00000,0.99996,0.00000,0.00000,0.00000,0.00000,0.99997,0.00001,0.99996,
0.00000,0.99996
)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results ZE', {
    skip("I don't care about this right now")
set.seed(2019)
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='ZE', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, 
c(
0.3072700000000000,0.3228100000000000,0.2584400000000000,
0.3558900000000000,0.3601700000000000,0.3418100000000000,
0.3852600000000000,0.4232200000000000,0.3806400000000000,
0.3380900000000000,0.3429000000000000,0.2862600000000000,
0.5333100000000000,0.6599100000000000,0.3031600000000000,
0.3763600000000000,0.3530600000000000,0.4377100000000000,
0.3582300000000000,0.3957100000000000,0.3283000000000000,
0.2829900000000000,0.2752800000000000,0.2979600000000000,
0.4179200000000000,0.2600300000000000,0.4207200000000000,
0.4116500000000000,0.4673300000000000,0.4078200000000000,
0.8490799999999999,0.2823200000000000,0.3266100000000000,
0.3390300000000000,0.3124400000000000,0.3449900000000000,
0.2989300000000000,0.3045300000000000,0.3932200000000000,
0.2894400000000000,0.5109399999999999,0.3739500000000000,
0.2899800000000000,0.3152600000000000,0.4527800000000000,
0.3371500000000000,0.3361200000000000,0.3429600000000000,
0.4814800000000000,0.5316400000000000,0.3025800000000000,
0.2989800000000000,0.3048400000000000,0.2969900000000000,
0.3382800000000000,0.2927700000000000,0.2964700000000000,
0.4498700000000000,0.2812300000000000,0.3913900000000000,
0.7489900000000000,0.3543100000000000,0.6298000000000000,
0.3890600000000000,0.2915300000000000,0.7833800000000000,
0.3534800000000000,0.2943900000000000,0.3044300000000000,
0.3640300000000000,0.9086500000000000,0.3502400000000000,
0.4669500000000000,0.3434600000000000,0.3223900000000000,
0.8493600000000000,0.4323400000000000,0.3816900000000000,
0.3792700000000000,0.3359000000000000,0.4094700000000000,
0.3527300000000000,0.3502000000000000,0.3860500000000000,
0.2902400000000000,0.2790300000000000,0.3496400000000000,
0.3489800000000000,0.2887300000000000,0.4258600000000000,
0.3026400000000000,0.3260100000000000,0.3497200000000000,
0.3128000000000000,0.2917600000000000,0.5627600000000000,
0.2814500000000000,0.2768800000000000,0.2723800000000000,
0.2862500000000000,0.3843800000000000,0.8277700000000000,
0.5384500000000000,0.3823700000000000,0.2683500000000000,
0.5612000000000000,0.3834500000000000,0.3066100000000000,
0.4043000000000000,0.3168100000000000,0.3169800000000000,
0.2739100000000000,0.5369800000000000,0.5291800000000000,
0.3833800000000000,0.2863400000000000,0.3684900000000000,
0.5533400000000001,0.2899700000000000,0.3105500000000000,
0.4019300000000000,0.3264600000000000,0.4868200000000000,
0.4719500000000000,0.4517700000000000,0.4150700000000000,
0.3257000000000000,0.2669600000000000,0.2904300000000000,
0.2782900000000000,0.4296300000000000,0.4636800000000000,
0.2931100000000000,0.8784800000000000,0.3002000000000000,
0.2729900000000000,0.4922000000000000,0.3859500000000000,
0.4582100000000000,0.5576900000000000,0.6193300000000000,
0.3316100000000000,0.3705900000000000,0.2861400000000000,
0.6840100000000000,0.4462500000000000,0.5289800000000000,
0.3609600000000000,0.3017000000000000,0.3686200000000000,
0.4566500000000000,0.4256400000000000,0.3627600000000000,
0.5163900000000000,0.7295800000000000,0.2828100000000000,
0.6754500000000000,0.2997800000000000,0.5095200000000000,
0.3129500000000000,0.5782700000000000,0.2870900000000000,
0.4172200000000000,0.6432099999999999,0.2922400000000000,
0.4412900000000000,0.2406500000000000,0.3053000000000000,
0.7484200000000000,0.2998000000000000,0.4271400000000000,
0.4707900000000000,0.2961300000000000,0.5917700000000000,
0.2772600000000000,0.3498500000000000,0.2996800000000000,
0.3008300000000000,0.4158700000000000,0.4240000000000000,
0.7877200000000000,0.2839900000000000,0.3613900000000000,
0.4009000000000000,0.7163700000000000,0.3260800000000000,
0.4611600000000000,0.6906900000000000,0.4531400000000000,
0.3078400000000000,0.5701300000000000,0.2944300000000000,
0.3725700000000000,0.2726800000000000,0.3058000000000000,
0.6885900000000000,0.5033600000000000,0.3223700000000000,
0.2634000000000000,0.3876600000000000
)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results liang_g1', {
			  skip("This currently fails with a GSL hyper_2F1 error")
set.seed(2019)
browser()
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='liang_g1', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, c(0.003888497230715404,
0.005603326220676895,
0.002933945443797199,
0.00228822150776619,
0.0026,
0.0042,
0.0021,
0.0035,
0.0016,
0.0023,
0.0596,
0.0035,
0.0032,
0.0034,
0.002,
0.0036,
0.0019,
0.0026,
0.0033,
0.0013,
0.0022,
0.0038,
0.0018,
0.002,
0.0023,
0.0025,
0.0012,
0.012,
0.0023,
0.0049,
0.0055,
0.0018,
0.004,
0.0019,
0.0019,
0.0105,
0.0022,
0.0035,
0.0027,
0.0019,
0.0017,
0.0436,
0.0021,
0.0028,
0.0017,
0.0027,
0.0033,
0.0024,
0.0037,
0.0058,
0.0021,
0.0036,
0.0023,
0.0116,
0.0122,
0.0017,
0.0018,
0.0026,
0.0042,
0.0108,
0.0024,
0.0394,
0.0034,
0.003,
0.003,
0.0089,
0.0027,
0.0023,
0.0018,
0.0019,
0.0185,
0.0015,
0.002,
0.0026,
0.0019,
0.0223,
0.0027,
0.0029,
0.0018,
0.0025,
0.0013,
0.0028,
0.0019,
0.0017,
0.0056,
0.0018,
0.1857,
0.0025,
0.0026,
0.0223,
0.0015,
0.008800000000000001,
0.003,
0.0022,
0.0025,
0.0063,
0.0023,
0.002,
0.019,
0.0018,
0.0025,
0.0101,
0.0017,
0.0049,
0.0015,
0.0014,
0.0045,
0.0049,
0.0254,
0.009599999999999999,
0.0046,
0.0201,
0.004,
0.0022,
0.0022,
0.0011,
0.0051,
0.0021,
0.0012,
9e-04,
0.0024,
0.0017,
0.008500000000000001,
0.0043,
0.0105,
0.0024,
0.0109,
0.0028,
0.002,
0.003,
0.002,
0.0091,
0.0027,
0.01,
0.0055,
0.0264,
0.0034,
0.001,
0.0018,
0.0129,
0.0158,
0.0023,
0.0032,
0.0018,
0.0025,
0.0116,
0.0077,
0.0055,
0.0017,
0.0018,
0.0039,
0.0039,
0.9422,
0.0069,
0.0365,
0.0029,
0.0098,
0.009299999999999999,
0.0153,
0.0021,
0.0066,
0.0074,
0.0026,
0.0193,
0.0021,
0.0023,
0.0021,
0.0029,
0.0023,
0.0036,
0.002,
0.0239,
0.0042,
0.0027,
0.0049,
0.0029,
0.0083,
0.0017,
0.0043,
0.7452,
0.0606,
0.0205,
0.0068,
0.0059,
0.7236,
0.0026,
0.0467,
0.0111,
0.0042,
0.004,
0.003,
0.0016,
0.0029,
0.0023,
0.0016,
0.0036,
0.002,
0.0033,
0.0051,
0.061)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results liang_g2', {
set.seed(2019)
browser()
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='liang_g2', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, 
c(
0.3214700000000000,0.3416500000000000,0.2992300000000000,
0.4014000000000000,0.3666200000000000,0.3589000000000000,
0.3331200000000000,0.4078700000000000,0.3273400000000000,
0.3497700000000000,0.3638000000000000,0.2996600000000000,
0.6089800000000000,0.5670200000000000,0.3116200000000000,
0.3750900000000000,0.3253100000000000,0.3904200000000000,
0.3715100000000000,0.3997600000000000,0.3473400000000000,
0.3157900000000000,0.3257800000000000,0.3230400000000000,
0.3388500000000000,0.2867500000000000,0.3320900000000000,
0.3267600000000000,0.3717700000000000,0.3438400000000000,
0.8050100000000000,0.3050900000000000,0.3394400000000000,
0.2998700000000000,0.3316700000000000,0.3750300000000000,
0.3218400000000000,0.3392200000000000,0.4243500000000000,
0.3269500000000000,0.5938800000000000,0.3789400000000000,
0.3109300000000000,0.3097800000000000,0.3664000000000000,
0.3770400000000000,0.3821000000000000,0.3681600000000000,
0.4187400000000000,0.5604900000000000,0.3396200000000000,
0.3034400000000000,0.3210400000000000,0.3202200000000000,
0.3459500000000000,0.3179200000000000,0.2928000000000000,
0.3978900000000000,0.3268900000000000,0.3974300000000000,
0.6982699999999999,0.3738800000000000,0.5348400000000000,
0.3122300000000000,0.3005100000000000,0.7429400000000000,
0.3706500000000000,0.2961600000000000,0.3382400000000000,
0.2850900000000000,0.8689200000000000,0.3430800000000000,
0.4355100000000000,0.3449600000000000,0.3359500000000000,
0.8140800000000000,0.3744800000000000,0.3250400000000000,
0.3130400000000000,0.3409800000000000,0.3985700000000000,
0.3728000000000000,0.2929800000000000,0.3135100000000000,
0.3049400000000000,0.3290500000000000,0.4218400000000000,
0.3751900000000000,0.3157200000000000,0.3637700000000000,
0.3180400000000000,0.3804400000000000,0.3859100000000000,
0.3145500000000000,0.3177100000000000,0.5937200000000000,
0.2987600000000000,0.3185200000000000,0.3053500000000000,
0.2953200000000000,0.3849000000000000,0.7360200000000000,
0.5091200000000000,0.3135800000000000,0.3022900000000000,
0.4720200000000000,0.3302000000000000,0.3254700000000000,
0.3310100000000000,0.3104500000000000,0.3409800000000000,
0.2913100000000000,0.4347400000000000,0.5464700000000000,
0.3086100000000000,0.3024000000000000,0.3592200000000000,
0.4473900000000000,0.3177200000000000,0.3193600000000000,
0.3342100000000000,0.3320300000000000,0.5365000000000000,
0.5102800000000000,0.4554400000000000,0.3568000000000000,
0.3139700000000000,0.3050400000000000,0.2982100000000000,
0.2841900000000000,0.3338400000000000,0.3917300000000000,
0.3126100000000000,0.8021600000000000,0.3173000000000000,
0.3131900000000000,0.3975200000000000,0.3000700000000000,
0.3790400000000000,0.5994000000000000,0.6083300000000000,
0.3783500000000000,0.3021000000000000,0.3189000000000000,
0.5761600000000000,0.3923000000000000,0.4662800000000000,
0.3566300000000000,0.3324800000000000,0.3884600000000000,
0.3801900000000000,0.4092300000000000,0.3902500000000000,
0.5465100000000001,0.6628300000000000,0.3046600000000000,
0.6193400000000000,0.3042900000000000,0.4087600000000000,
0.3215300000000000,0.4902200000000000,0.3031900000000000,
0.4241900000000000,0.5317400000000000,0.3128400000000000,
0.4410800000000000,0.2800400000000000,0.3291000000000000,
0.6523700000000000,0.3218500000000000,0.4851000000000000,
0.3792100000000000,0.3307700000000000,0.6756300000000000,
0.2948600000000000,0.4093000000000000,0.3169100000000000,
0.3258900000000000,0.4328400000000000,0.3965700000000000,
0.7402000000000000,0.3059300000000000,0.3750000000000000,
0.4318300000000000,0.6282300000000000,0.3179000000000000,
0.4834600000000000,0.5970700000000000,0.3628300000000000,
0.3061400000000000,0.5934000000000000,0.3189000000000000,
0.3930700000000000,0.3118100000000000,0.3295700000000000,
0.6352700000000000,0.4346400000000000,0.2956400000000000,
0.3041600000000000,0.4318700000000000
)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results liang_g_n_approx', {
    skip('Not done yet!')
set.seed(2019)
browser()
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='liang_g_n_approx', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, c(0.003088497230715404,
0.002703326220676895,
0.001333945443797199,
0.00248822150776619,
0.0029,
0.0028,
0.0015,
0.003,
0.0017,
0.0021,
0.0544,
0.0021,
0.0025,
0.0012,
0.0013,
0.0034,
8e-04,
5e-04,
0.002,
0.0013,
0.0012,
0.0015,
0.0015,
0.0014,
0.0013,
0.0027,
8e-04,
0.0098,
0.0013,
0.0028,
0.0035,
0.0017,
0.0014,
0.0011,
0.0013,
0.0055,
8e-04,
0.0019,
0.0021,
9e-04,
0.0012,
0.0293,
0.001,
0.001,
0.0011,
0.0022,
0.001,
0.0013,
0.0015,
0.0043,
0.0005999999999999999,
0.0025,
0.0011,
0.0083,
0.0092,
0.0017,
0.0013,
0.0021,
0.0027,
0.0071,
0.0015,
0.0198,
0.0015,
0.0022,
0.0014,
0.0051,
0.0011,
0.0015,
0.0014,
0.0018,
0.0111,
0.0013,
0.0011,
0.0012,
0.0013,
0.0152,
0.0015,
0.0024,
0.0013,
0.0011,
0.001,
0.0017,
0.001,
9e-04,
0.0035,
0.0019,
0.1379,
0.0017,
0.0016,
0.0186,
0.0014,
0.0064,
0.0027,
0.0011,
0.0011,
0.0025,
0.0015,
9e-04,
0.015,
0.0024,
0.002,
0.007900000000000001,
0.0012,
0.0027,
7e-04,
0.0016,
0.0024,
0.0026,
0.014,
0.0066,
0.0038,
0.0147,
0.0035,
0.001,
0.0016,
0.001,
0.0032,
5e-04,
0.0015,
0.0018,
0.0021,
0.0011,
0.0069,
0.003,
0.006,
0.0015,
0.007,
8e-04,
4e-04,
0.0018,
0.001,
0.0075,
9e-04,
0.0067,
0.0049,
0.0197,
0.0015,
0.0013,
0.0011,
0.0054,
0.0091,
7e-04,
0.0014,
0.0015,
0.0013,
0.0056,
0.0065,
0.0027,
0.001,
9e-04,
0.0033,
0.0024,
0.9731,
0.0046,
0.0142,
0.0014,
0.0051,
0.0071,
0.009900000000000001,
0.0012,
0.003,
0.0055,
0.002,
0.0131,
0.0011,
0.0019,
0.0011,
0.0014,
0.0013,
0.0027,
0.0014,
0.0166,
0.0027,
0.0013,
0.0036,
0.0021,
0.007,
0.0011,
0.0019,
0.8143,
0.0452,
0.0152,
0.0049,
0.0031,
0.8081,
0.0021,
0.0411,
0.008399999999999999,
0.0036,
0.0032,
0.0019,
0.001,
0.0016,
0.001,
9e-04,
0.0027,
0.0017,
0.0015,
0.0035,
0.0448)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results liang_g_n_quad', {
    skip('Not done yet!')
set.seed(2019)
browser()
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='liang_g_n_quad', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, c(0.002488497230715403,
0.004403326220676894,
0.001733945443797199,
0.00138822150776619,
0.0027,
0.0042,
0.0014,
0.0033,
0.0017,
0.0015,
0.0507,
0.0035,
0.003,
0.0019,
0.0011,
0.0026,
0.0019,
0.0014,
0.0027,
0.0011,
0.0012,
0.0024,
0.0023,
0.0014,
0.0017,
0.0051,
0.0019,
0.009299999999999999,
0.0018,
0.0039,
0.0039,
0.0016,
0.0022,
0.0015,
0.0016,
0.0039,
0.0016,
0.0023,
0.0023,
0.0024,
0.0014,
0.0424,
0.0017,
0.0018,
8e-04,
0.0016,
0.0012,
0.0015,
0.0013,
0.0058,
0.0011,
0.0031,
0.0015,
0.0113,
0.0097,
0.0014,
0.0016,
0.0021,
0.0032,
0.0098,
0.0018,
0.0318,
0.0014,
0.0021,
0.0025,
0.0066,
0.0023,
0.0018,
0.0025,
0.0018,
0.014,
0.002,
0.0017,
0.0023,
0.0027,
0.0153,
0.0016,
0.0026,
8e-04,
0.0028,
0.0014,
0.0012,
0.0012,
0.002,
0.0046,
0.0027,
0.1731,
0.0022,
0.0017,
0.0194,
0.0012,
0.0056,
0.0028,
0.0012,
0.002,
0.0046,
0.0021,
0.0016,
0.0131,
0.0027,
0.002,
0.007900000000000001,
0.001,
0.0036,
0.0013,
0.0021,
0.0035,
0.0037,
0.0286,
0.008999999999999999,
0.0049,
0.0155,
0.0042,
0.0023,
0.0017,
0.0012,
0.0035,
0.002,
0.0018,
0.0019,
8e-04,
0.0013,
0.0061,
0.0027,
0.0078,
0.0012,
0.008800000000000001,
0.0026,
0.0017,
0.0013,
0.0021,
0.008800000000000001,
0.0012,
0.008399999999999999,
0.0043,
0.0226,
0.0024,
0.0013,
0.0023,
0.009599999999999999,
0.0142,
0.0016,
0.0018,
0.002,
8e-04,
0.0057,
0.007,
0.0039,
0.0013,
0.0022,
0.0024,
0.0015,
0.9498,
0.0059,
0.0295,
0.0012,
0.0077,
0.0071,
0.0168,
0.0021,
0.0071,
0.0068,
0.0026,
0.0138,
0.0018,
0.001,
0.0015,
0.0023,
0.0011,
0.0035,
9e-04,
0.0232,
0.0034,
0.0018,
0.0038,
0.0032,
0.0061,
0.0014,
0.0033,
0.7664,
0.067,
0.0199,
0.0078,
0.0048,
0.7262999999999999,
0.0023,
0.0448,
0.0083,
0.0046,
0.003,
0.0023,
0.0017,
0.0014,
0.001,
0.0016,
0.0043,
0.0022,
0.0023,
0.0032,
0.0479)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results robust_bayarri1', {
    skip('Not done yet!')
set.seed(2019)
browser()
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='robust_bayarri1', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, c(0.003788497230715404,
0.005003326220676895,
0.001633945443797199,
0.00268822150776619,
0.0027,
0.0043,
0.0021,
0.0038,
0.0021,
0.0024,
0.0591,
0.0026,
0.0038,
0.0025,
0.002,
0.0037,
0.0023,
0.0025,
0.0037,
0.0017,
0.0018,
0.0021,
0.0023,
0.0014,
0.0024,
0.0036,
0.0012,
0.0111,
0.0013,
0.0035,
0.0036,
0.001,
0.003,
0.0017,
0.0013,
0.0053,
0.0028,
0.0035,
0.0018,
0.0022,
0.0015,
0.0365,
0.0023,
0.0017,
0.002,
0.0026,
0.0021,
0.0029,
0.0024,
0.0048,
0.0017,
0.0032,
0.0017,
0.0125,
0.0116,
0.0021,
0.0019,
0.0028,
0.0026,
0.0089,
0.0015,
0.0281,
0.003,
0.003,
0.0019,
0.0074,
0.0022,
0.0028,
0.0012,
0.0022,
0.0167,
0.0011,
0.0019,
0.0028,
0.0016,
0.0193,
0.0018,
0.0021,
0.0015,
0.0024,
0.0023,
0.0016,
0.002,
0.0017,
0.0034,
0.0018,
0.1821,
0.0019,
0.0025,
0.0229,
0.0019,
0.0045,
0.003,
0.0019,
0.0015,
0.0046,
0.0024,
0.0014,
0.0167,
0.0026,
0.0025,
0.01,
0.0019,
0.0034,
0.0015,
0.0017,
0.0035,
0.0045,
0.0285,
0.0092,
0.0035,
0.02,
0.0041,
0.0023,
0.0023,
0.0016,
0.0035,
0.0028,
0.0019,
0.0026,
0.0026,
0.0016,
0.009599999999999999,
0.0046,
0.0091,
0.0019,
0.0109,
0.0024,
0.0021,
0.0018,
0.0016,
0.009299999999999999,
0.0022,
0.0112,
0.0057,
0.0273,
0.0014,
0.0012,
0.0021,
0.0116,
0.0114,
0.0011,
0.0017,
0.0021,
0.002,
0.0072,
0.0089,
0.0041,
0.0015,
0.0015,
0.0029,
0.0031,
0.9448,
0.0063,
0.0329,
0.0012,
0.0101,
0.0098,
0.0139,
0.0027,
0.007900000000000001,
0.0078,
0.0023,
0.0156,
0.0026,
0.0019,
0.0012,
0.0024,
0.0016,
0.004,
0.0015,
0.0299,
0.0041,
0.0023,
0.0041,
0.0029,
0.0066,
0.002,
0.004,
0.7491,
0.0534,
0.0203,
0.0071,
0.006,
0.7233000000000001,
0.0022,
0.0546,
0.0129,
0.0038,
0.0032,
0.0021,
0.0017,
0.001,
0.0013,
0.0014,
0.0051,
0.0015,
0.0023,
0.0051,
0.0559)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results robust_bayarri2', {
    skip('Not done yet!')
set.seed(2019)
browser()
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='robust_bayarri2', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob, c(0.004388497230715403,
0.004503326220676894,
0.001733945443797199,
0.00158822150776619,
0.0027,
0.004,
0.0017,
0.0034,
0.0019,
0.0021,
0.0606,
0.0035,
0.0028,
0.0026,
0.0017,
0.0034,
0.0017,
0.0024,
0.0031,
0.0014,
0.0019,
0.002,
0.002,
0.0013,
0.0019,
0.0039,
0.002,
0.009599999999999999,
0.0018,
0.0042,
0.0047,
0.0012,
0.0027,
0.0014,
0.001,
0.008,
0.0028,
0.0031,
0.0016,
0.0018,
0.0023,
0.042,
0.002,
9e-04,
0.0016,
0.0016,
0.0018,
0.0021,
0.0021,
0.0077,
0.0015,
0.0021,
0.0018,
0.0128,
0.0101,
0.001,
0.0017,
0.003,
0.0026,
0.0101,
0.0023,
0.0297,
0.0026,
0.0026,
0.0029,
0.008200000000000001,
0.0031,
0.0025,
0.0011,
0.0028,
0.0151,
0.0011,
0.0018,
0.0029,
0.0012,
0.0171,
0.0014,
0.0029,
0.001,
0.0017,
0.0018,
0.0019,
0.002,
0.0016,
0.0045,
0.0021,
0.1909,
0.0034,
0.0027,
0.0216,
8e-04,
0.0062,
0.0021,
0.0018,
0.0011,
0.0046,
0.0019,
0.0018,
0.0139,
0.0024,
0.0029,
0.0107,
0.0011,
0.0034,
0.0016,
0.0015,
0.0037,
0.0043,
0.0277,
0.0089,
0.0042,
0.0165,
0.0043,
0.0018,
0.0027,
0.0015,
0.0033,
0.0017,
0.0022,
0.0015,
0.0025,
0.0023,
0.008500000000000001,
0.003,
0.0077,
0.0023,
0.0126,
0.0019,
0.0019,
0.002,
0.0017,
0.008999999999999999,
0.0015,
0.0094,
0.0039,
0.0258,
0.0027,
0.0014,
0.0032,
0.0141,
0.009900000000000001,
0.0019,
0.0033,
0.0013,
0.0016,
0.009299999999999999,
0.0075,
0.0041,
0.0018,
0.0021,
0.0038,
0.0024,
0.9369,
0.005,
0.0428,
0.0021,
0.008999999999999999,
0.009599999999999999,
0.0176,
0.0021,
0.0059,
0.007,
0.0031,
0.0167,
0.0024,
0.002,
0.0015,
0.0025,
0.0016,
0.0038,
0.0022,
0.0276,
0.004,
0.002,
0.0042,
0.0023,
0.0062,
0.0016,
0.0025,
0.7402,
0.056,
0.0194,
0.007900000000000001,
0.0062,
0.7208,
0.0021,
0.0464,
0.0115,
0.0047,
0.0022,
0.0025,
0.0019,
0.0012,
0.0011,
0.002,
0.0049,
0.0022,
0.0027,
0.0052,
0.0556)
, tolerance = 1e-8)
})
test_that('eyeData produces correct results zellner_siow_gauss_laguerre', {
    skip('Not done yet!')
set.seed(2019)
browser()
eyeData <- get_eyeData()
    vy <- eyeData$vy
    mX <- eyeData$mX
    result <- sampler(100000, vy, mX, prior='zellner_siow_gauss_laguerre', modelprior='uniform', cores=cores)
    expect_equal(result$vinclusion_prob,
    			 c()
, tolerance = 1e-8)
})
